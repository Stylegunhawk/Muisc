<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Analysis Result</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
      /* Only for fallback if not present in style.css */
      .results-details { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
      @media (max-width: 900px) { .results-details { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
<div class="app-layout">
    <header class="header">
        <div class="logo">üîç Analysis Results</div>
        <a href="/" class="back-btn"><span class="back-icon">‚¨Ö</span> <span class="back-text">Back to Main</span></a>
    </header>
    <div class="results-content">
        <section class="genre-prediction">
            <h2>üéº Predicted Genre: <span>{{ genre }}</span></h2>
            <div class="confidence-scores">
                <h3>Confidence Scores:</h3>
                <ul>
                    {% set class_labels = ["Blues", "Classical", "Country", "Disco", "Hip-Hop", "Jazz", "Metal", "Pop", "Reggae", "Rock"] %}
                    {% for i in range(confidence|length) %}
                        <li>
                            <div class="score-label">{{ class_labels[i] }}: {{ '%.2f'|format(confidence[i] * 100) }}%</div>
                            <div class="confidence-bar">
                                <div class="confidence-fill" style="width: {{ (confidence[i] * 100)|round(0, 'floor') }}%"></div>
                            </div>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </section>
        <div class="results-details">
            <section class="features-display">
                <h3>üéö Extracted Features</h3>
                <ul class="feature-list">
                    {% for key, value in features.items() %}
                        <li class="feature-item">
                            <div class="feature-name">{{ key.capitalize() }}</div>
                            <div class="feature-bar">
                                <div class="feature-bar-fill {% if key in ['energy', 'danceability', 'loudness'] %}{{ key }}{% endif %}" style="width: {{ (value * 100)|round(0, 'floor') }}%"></div>
                            </div>
                            <div class="feature-value">{{ value }}</div>
                        </li>
                    {% endfor %}
                </ul>
            </section>
            <section class="recommendation-list">
                <h3>üéß Recommended Songs ({{ genre }})</h3>
                <ol>
                    {% for rec in recommendations %}
                        <li class="recommendation-item">
                            <div class="song-title">{{ rec.song }}</div>
                            <div class="song-artist">‚Äî {{ rec.artist }}</div>
                        </li>
                    {% endfor %}
                </ol>
            </section>
        </div>
    </div>
    <div class="toast-container" id="toastContainer"></div>
    <div class="loading-overlay" id="loadingOverlay" style="display:none;">
        <div class="loading-spinner"></div>
    </div>
</div>
<script>
function showToast(msg, type) {
    const toast = document.createElement('div');
    toast.className = `toast show ${type}`;
    toast.innerHTML = `<span class='toast-icon'>${type === 'success' ? '‚úÖ' : '‚ö†Ô∏è'}</span><span class='toast-message'>${msg}</span><button class='toast-close' onclick='this.parentNode.remove()'>√ó</button>`;
    document.getElementById('toastContainer').appendChild(toast);
    setTimeout(() => { toast.classList.remove('show'); setTimeout(() => toast.remove(), 300); }, 3500);
}
function showLoader(show) {
    document.getElementById('loadingOverlay').style.display = show ? 'flex' : 'none';
}
</script>
</body>
</html>
